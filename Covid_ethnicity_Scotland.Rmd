
---
title: "Briefing paper on Ethnicity and COVID-19 status in Scotland"

author: Modelling & Research Cell, Health Protection Scotland 

date: "`r gsub('^0', '', format(Sys.time(), '%d %B %Y'))`"

header-includes: |
  \let\origquote\quote
  \def\quote{\origquote\itshape}
  \usepackage{graphicx}
  \usepackage{longtable}
  \usepackage{booktabs}
  \usepackage{float}
  \usepackage{array}
  \usepackage{longtable}
  \usepackage{lscape}

output:
  pdf_document:
  keep_tex: true
  latex_engine: lualatex

# rmarkdown::render("Covid_ethnicity_Scotland.Rmd")

---

# Background
There have been anecdotal reports of an excess of hospitalisations, intensive care unit need and death from COVID-19 among non-white ethnic groups in particular Black or Black British and South Asian.  A preliminary study using UK Biobank data has [reported](http://medrxiv.org/cgi/content/short/2020.04.22.20075663) that Black, South Asian and White Irish people were more likely to have confirmed infection (RR 4.01 (95% CI 2.92-5.12); RR 2.11 (95% CI 1.43-3.10); and RR 1.60 (95% CI 1.08-2.38) respectively) 

Understanding whether such inequity in risk of COVID-19 by ethnicity pertains in Scotland and whether disease severity is worse is relevant to early anticipation of health care needs, triaging algorithms being used by NHS Hubs, and shielding policies.

# Methods 
The REACT-SCOT case-control study was set up to investigate risk factors for severe COVID-19 and to lay the basis for developing risk stratification algorithms. All persons to date  who tested positive  for SARS-CoV-2 RNA were identified using the ECOSS virology laboratory systems. This system records CHI but not ethnicity.

A matched set of 10 controls per case matched for age, sex and GP practice was identified using the CHI database as part of the REACT-COVID19 case control study led by the Modelling & Research cell. 

## Coding of ethnicity
Names of cases and controls were available to the CHI team. They used the ONOMAP software to assign predicted ethnicity to all cases and controls. This was output in anonymised format to the Modelling & Research Cell linkage team. ONOMAP is a software package developed by Mateos at UCL which used people's first and family names to estimate underlying ethnic group. It has been developed using algorithms built from the Worldnames database that covered both names and ethnic group in a large number of countries. ONOMAP assigns both predicted geographical region of origin and ethnicity. ONOMAP has previously been reported to have variable sensitivity for assigning non-White ethnic groups. ([Lakha 2011](https://www.ncbi.nlm.nih.gov/pubmed/21907365)) The ONOMAP "Onolytic Types" were used to assign ethnicity. Names classified "Muslim" in the ONOMAP classification were assigned to the South Asian group, as Scotland most people with Muslim names are South Asian.  The ONOMAP classification assigns a high proportion of names in Scotland to the category "Celtic" which does not distinguish Irish from Scottish names so that White Irish cannot be differentiated from White British.

Hospital discharge and outpatient attendance data (SMR01 and SMR00 respectively) have increased in their completion of mandatory ethnic group in recent years. For all cases and controls the linkage team extracted i) the most recent ii) the most frequent ethnic group assignation from these two datasets  with a 10 year lookback period. Unknown or missing codes were excluded.  Concordance between the most recent SMR ethnic group   and the most frequent  SMR ethnic group was 98%. 

A previous comparison of ONOMAP against SMR01 records in Scotland concluded that SMR01 records with a missing ethnic group code were broadly representative of records with ethnicity recorded (Clark & Buchanan ISD 2017).  The classification given below follows the Census categories, collapsed into five groups: White, Black, South Asian, Chinese, Other.  The Black category combines those who self-identify as Black British, Black Caribbean, Black African and Black Other. 

The rate ratios shown are based on conditional logistic regression.  With the incidence density sampling used in this study, the odds ratios in a conditional logistic regression are equal to rate ratios.  The unconditional odds ratios calculated from the numbers of cases and controls in the tables are not the same as the conditional odds ratios. 

# Results
## Agreement between ethnicity assigned by name classification (ONOMAP) and self-reported ethnicity in  SMR records

Table \ref{tab:crosstab} shows that the ONOMAP name classification assigns to the same as self-reported category `r table.ethnic[1, 1]` of those who self-report their ethnicity as White, `r table.ethnic[5, 5]` of those who self-report as South Asian, `r table.ethnic[3, 3]` of those who self-report as Chinese, but only `r table.ethnic[2, 2]` of those who self-report as Black.  

In all further analyses, the ONOMAP classification has been collapsed to four groups: White, South Asian, Chinese, Other.  Analyses that distinguish the Black group can be done only for the subset of individuals who have SMR records. 

## Relation of test -positive, hospitalised and severe / fatal COVID-19 to ethnicity in the Scottish population
Tables \ref{tab:testpos.ethnicsmr}. \ref{tab:ethnicsmr.hosp} and \ref{tab:ethnicsmr} compare cases and controls with ethnicity based on SMR classification for all test positive cases, all hospitalized cases, and severe cases.  Severe cases are those who had ICU care or died within 28 days of a positive test. The first column of rate ratios are univariate. Those in the second column are further adjusted for SIMD and care home status.

Table \ref{tab:testpos.onomap}, \ref{tab:onomap.hosp}, \ref{tab:onomap} show the same comparisons with ethnicity based on ONOMAP name classification.

SMR based ethnicity was available in 23833 Controls  and 4230 test-positive cases. In contrast name based classification was available in 113894 Controls and 11432 test positive cases. Thus in the ethnic groups, such as South Asians,  for whom the named based classification has good performance  the named based estimates are more stable and the confidence intervals on the rate ratios are narrower. 

Using SMR based ethnicity there is no significant difference in test positivity rate by ethnicity.  Although rate ratios are above 1 for black ethnicity the  absolute numbers are sparse, just 15 test positives and the confidence intervals are very wide. For those of South Asian ethnicity using SMR based classification the rate ratio is  also above 1 with a wide confidence interval.  Using the named based classification for which there are much more data  for those of South Asian ethnicity the rate ratio is  actually well below 1  and this is statistically significant. For those of Chinese  ethnicity the name based classification showed lower test positive rates also. 

There is no evidence that the frequency of  hospitalised COVID-19 disease or severe disease warranting ICU or resulting in death within 28 days among those who test positive is any higher in non-White groups than in Whites.  Using the SMR based classification there are no differences by ethnic group in hospitalised COVID-19  or in severe COVID-19.  Using the named based classification for which there are more data the  rate ratios for the non-White ethnic groups are lower than Whites and this is statistically significant in those of South Asian ethnicity.

Tables \ref{tab:severity.smr} and \ref{tab:severity} show the distribution over severity categories by ethnicity

Tables \ref{tab:carehome} and \ref{tab:board} show the distribution of care home status and health board. 

# Conclusion
There is no evidence that those of non-white ethnicity are at higher risk of COVID-19 disease that Whites at this stage in this epidemic in Scotland. Rates of hospitalised and severe disease were lower in those of South Asian ethnicity than Whites. For other non-White ethnic group the numbers of cases are so small that all estimates are unstable. 

For the Black population, reliable classification of ethnicity is restricted to those who have an SMR record because name based classification performs poorly for this ethnic group. ONOMAP/ name based classification does not reliably distinguish people of Black-Caribbean heritage from people of European ancestry.   The numbers of cases and controls in this group are too small for rate ratios to be reliably estimated so whilst we do not observe any elevations in rates the data are too sparse. Recording of ethnicity in hospital admission distinguishes these groups but does not provide complete coverage of the population at risk of COVID-19.  The coding is also incomplete with substantial missingness. 

We have not merged ethnicity data from the Scottish Morbidity Record with name based classification as this would introduce differential misclassification of ethnicity by health status.  Access to primary care data would likely increase the completeness with which ethnicity is assigned but governance issues have not been resolved.

We will continue to regularly report on the ethnicity distribution  as the epidemic progresses. In particular in further data extracts we hope to include those NRS reported deaths with COVID-19 emergency code on the certificate but where no positive test has been recorded. Further data extracts will in due course also capture the lighthouse testing data that are as yet not included in the ECOSS database. 


\newpage

# Tables
Tables comparing all test-positive individuals with controls are included by request.  They should be interpreted with caution, as selection for testing is influenced by many factors including health care worker status.  Similar considerations apply to comparisons of disease severity among those who test positive.  


```{r ethnic, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(table.ethnic, 
             escape=FALSE, 
             booktabs=TRUE,
             caption="\\label{tab:crosstab}Comparison of ethnicity assigned by ONOMAP name classification (rows) with ethnicity assigned in SMR  records (columns)") %>%
    add_header_above(c(" "=1, "SMR records"= 6)) %>%
    pack_rows("ONOMAP", 1, 5) %>%
    kable_styling(latex_options="hold_position") 

```

```{r ethnicsmr.testpos, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.testpositives.demog.ethnicsmr) <-
    gsub("_", " ", rownames(table.testpositives.demog.ethnicsmr))
knitr::kable(table.testpositives.demog.ethnicsmr,
             escape=FALSE, 
             booktabs=TRUE,
             label="testpos.ethnicsmr",
             col.names=c(clean.header(colnames(table.testpositives.demog.ethnicsmr)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6), 
             caption="Associations of test-positive status with ethnicity in those with ethnicity recorded in Scottish Morbidity record") %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2.7cm")  %>%
    column_spec(column=2, width="2cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")
```


```{r ethnicsmr.hosp, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.hospitalized.demog.ethnicsmr) <-
    gsub("_", " ", rownames(table.hospitalized.demog.ethnicsmr))
knitr::kable(table.hospitalized.demog.ethnicsmr,
             escape=FALSE, 
             booktabs=TRUE,
             label="ethnicsmr.hosp",
             col.names=c(clean.header(colnames(table.hospitalized.demog.ethnicsmr)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6), 
             caption="Associations of hospitalized disease with ethnicity in those with ethnicity recorded in Scottish Morbidity record") %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2.7cm") %>%
    column_spec(column=2, width="2cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")

```

```{r ethnic5smr, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.ethnic5smr) <- gsub("_", " ", rownames(table.ethnic5smr))
knitr::kable(table.ethnic5smr,
             escape=FALSE, 
             booktabs=TRUE,
             label="ethnicsmr",
             col.names=c(clean.header(colnames(table.ethnic5smr)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6), 
             caption="Associations of severe disease with ethnicity in those with ethnicity recorded in Scottish Morbidity record") %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2cm") %>%
    column_spec(column=2, width="1.85cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")
```


```{r testpositives.ethnic.smr, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(testpositives.ethnic.smr, 
           escape=FALSE, 
             booktabs=TRUE,
       caption="\\label{tab:severity.smr}Severity of disease in test-positive cases, by ethnicity assigned in SMR records") %>%
    kable_styling(latex_options="hold_position") 

```


\newpage

```{r onomap.testpos, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.testpositives.demog) <- gsub("_", " ", rownames(table.testpositives.demog))
knitr::kable(table.testpositives.demog,
             escape=FALSE, 
             booktabs=TRUE,
             label="testpos.onomap",
             col.names=c(clean.header(colnames(table.testpositives.demog)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6), 
             caption="Associations of test-positive status with ethnicity based on name classification") %>%
    add_header_above(c(" "=3, "Univariate"=2, "Multivariate"=2)) %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2.7cm") %>%
    column_spec(column=2, width="1.95cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")

```


```{r onomap.hosp, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.hospitalized.demog) <- gsub("_", " ", rownames(table.hospitalized.demog))
knitr::kable(table.demog.aug,
             escape=FALSE, 
             booktabs=TRUE,
             label="onomap.hosp",
             col.names=c(clean.header(colnames(table.hospitalized.demog)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6), 
             caption="Associations of hospitalized disease with demographic variables including ethnicity based on name classification") %>%
    add_header_above(c(" "=3, "Univariate"=2, "Multivariate"=2))  %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2.7cm") %>%
    column_spec(column=2, width="2cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")

```

```{r onomap, echo=FALSE, warning=FALSE, message=FALSE}

rownames(table.severe.demog) <- gsub("_", " ", rownames(table.severe.demog))
knitr::kable(table.severe.demog,
             escape=FALSE, 
             booktabs=TRUE,
             label="onomap",
             col.names=c(clean.header(colnames(table.severe.demog)[1:2]),
                         "Rate ratio (95\\% CI)", "p-value",
                         "Rate ratio (95\\% CI)", "p-value"),
             align=rep("c", 6),
             caption="Associations of severe disease with demographic variables including ethnicity based on name classification") %>%
    kable_styling(latex_options="hold_position") %>% 
    column_spec(column=1, width="2cm") %>%
    add_header_above(c(" "=3, "Univariate"=2, "Multivariate"=2)) %>%
    column_spec(column=2, width="1.85cm")  %>%
    column_spec(column=3, width="1.85cm")  %>%
    column_spec(column=4, width="2.5cm") %>%
    column_spec(column=5, width="1.5cm") %>%
    column_spec(column=6, width="2.5cm") %>%
    column_spec(column=7, width="1.5cm")

```

```{r testpositives.ethnic, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(testpositives.ethnic, 
           escape=FALSE, 
             booktabs=TRUE,
       caption="\\label{tab:severity}Severity of disease in test-positive cases, by ethnicity assigned from ONOMAP name classification") %>%
    kable_styling(latex_options="hold_position") 

```

```{r testpositives.carehome, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(testpositives.carehome, 
           escape=FALSE, 
             booktabs=TRUE,
       caption="\\label{tab:carehome}Care home status in test-positive cases, by ethnicity assigned from ONOMAP name classification") %>%
    kable_styling(latex_options="hold_position") 

```

\newpage 

```{r testpositives.healthboard, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(testpositives.healthboard, 
             escape=FALSE, 
             booktabs=TRUE,
             caption="\\label{tab:board}Health board of residence in test-positive cases, by ethnicity assigned from ONOMAP name classification") %>%
    kable_styling(latex_options="hold_position") 

```
