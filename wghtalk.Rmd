---
title: "Controlling and mitigating the COVID-19 epidemic -- insights from record linkage studies in Scotland" 
author: Paul McKeigue 
date: "`r gsub('^0', '', format(Sys.Date(), '%d %B %Y'))`"
output: 
  beamer_presentation:
    slide_level: 1
    includes:
      in_header: ../beamer_header.tex
    latex_engine: lualatex
    keep_tex: yes
---

# REACT-SCOT study

* Case-control study of all diagnosed cases of COVID-19 in Scotland since March 2020

  - Cases include those without a positive test, ascertained through hospital discharge diagnosis or death certificates. 
  
  - Ten controls per case, not previously diagnosed and matched for age, sex and general practice

  - linkage to household composition, medical records including hospital admissions, prescribing in primary care

# Severe COVID-19: main outcome variable

* Fatal outcome defined as death within 28 days of a positive test, or death at any time with COVID-19 coded as underlying cause

* Severe COVID-19 defined as entry to critical care within 21 days of presentation date, or fatal outcome

  - definition ensures that case ascertainment is not affected by triage of those assessed as unlikely to benefit from critical care  

# Studies based on REACT-SCOT

* Co-morbidity and construction of a risk score ("COVID age")

* Pharmacoepidemiology: medications compromising COVID

* Shielding and hospital transmission

* Other studies: ethnicity, health care workers, teachers, living with children, variant B.1.1.7, vaccine efficacy


# Risk score as "COVID age": some vulnerable individuals not yet vaccinated 

![](COVIDage_vaxstatus.png)

 
# Relation of severe COVID-19 to polypharmacy

![](plot.numdrugsgr-1.png)

# Laporte & Healy (April 2020): "Medications compromising COVID"

* proton pump inhibitors

* hypnotics, sedatives 

* antipsychotics, drugs used in nausea and vertigo 

* opioid analgesics 

* gabapentinoids 

* non-steroidal anti-inflammatory drugs.

* anticholinergic effects likely to increase risk of pneumonia: 

  - H1 antihistamines, antidepressants, urinary antispasmodics, gastrointestinal antispasmodics, drugs for vertigo, antimuscarinic drugs used for parkinsonism, and antiepileptic drugs

# Univariate associations of severe COVID-19 with antipsychotic drugs

\begin{tabular}{lrrrl}
 &  Rate ratio (95\% CI) & $p$-value \\
Aripiprazole & 3.19 (1.61, 6.33) &  $9 \times 10^{-4}$ \\
Olanzapine & 2.68 (1.57, 4.56)  & $3 \times 10^{-4}$ \\
Levomepromazine  & 9.9  (4.7, 20.6) &  $1 \times 10^{-9}$ \\
Risperidone & 4.90  (3.26, 7.38) & $3 \times 10^{-14}$ \\
Haloperidol  &  9.9 (3.6, 26.9) & $7 \times 10^{-6}$ \\
Chlorpromazine hydrochloride  & 3.00  (1.28, 7.03) & 0.01 \\ 
Amisulpride  & 6.0 (1.7, 21.4) &  0.005 \\
\end{tabular}

# Conditions designated as eligible for shielding

1. Solid organ transplant recipient

2. Cancer of the blood or bone marrow, or people with cancer receiving treatments that affect  immune system 

3. Severe respiratory conditions: cystic fibrosis, asthma, chronic obstructive airway disease, bronchiectasis, pulmonary hypertension

4. Rare diseases that increase risk of infections: severe combined immunodeficiency, sickle cell disease. 

5. People on immunosuppression therapies sufficient to increase risk of infection

6. Pregnant with heart disease

7. Additional conditions: dialysis, splenectomy, others identified by clinicians

# The shielding programme

* List of eligible individuals generated by querying medical records including hospital discharge diagnoses, dispensed prescriptions and transplant registries

  - supplemented by data requested from clinicians
  
* First batch of shielding letters sent on 4 April 2020

  - advised strict isolation, offered support with home delivery of food and medication. 
  
  - no support for other household members to co-isolate. 

* Shielding programme was paused on 1 April 2020, 

* Further letter issued on 25 November 2020 advising "extra protection" based on current protection level in that area.  

# Shielding eligibility cohort by case status
\scriptsize

```{r shieldcasegroup, echo=FALSE, warning=FALSE, message=FALSE}

knitr::kable(table.shield.casegr, 
             escape=FALSE, 
             booktabs=TRUE,
			 label="shieldcasegroup",
             row.names=TRUE,
             align=rep("r", 5)) %>%
    kableExtra::group_rows("Shielding eligibility category", 2, 7) %>%
    column_spec(column=1, width="2.5cm") %>%
    column_spec(column=2, width="1.9cm") %>%
    column_spec(column=3, width="1.7cm") %>%
    column_spec(column=4, width="1.5cm") %>%
    column_spec(column=5, width="1.4cm") %>%
    column_spec(column=6, width="1.5cm") %>%
        add_footnote(label="Percentages are row percentages",
                     notation="none") 

```

# Severe cases by risk category and date of presentation: ribbon plot
```{r plotcasesbydate, echo=FALSE, warning=FALSE, message=FALSE, fig.width=4,fig.asp=0.75, fig.cap="Care home residents excluded"}

options(knitr.kable.NA = '')
options(knitr.table.format = "latex") # adds tab: prefix to labels
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)

theme_set(theme_gray(base_size = 12))

p.byelig
```

# Rate ratios for severe COVID-19 associated with risk conditions
\scriptsize
\setbeamertemplate{caption}{\raggedright\insertcaption\par}

```{r  rateratiosshielded, echo=FALSE, warning=FALSE, message=FALSE}

options(knitr.table.format = "latex") # adds tab: prefix to labels

knitr::kable(table.shielded.severecases.nocare[1:8, c(1:2, 5:6)], 
             escape=FALSE, 
             booktabs=TRUE,
			 label="coxfatal",
             row.names=TRUE,
             align=c("r", "r", "l", "l"), 
   col.names=c(clean.header(colnames(table.shielded.severecases.nocare)[1:2]),
                "Rate ratio (95\\% CI)", "p-value")) %>%
    column_spec(column=1, width="2cm") %>%
    column_spec(column=2, width="2cm") %>%
    column_spec(column=3, width="1.5cm") %>%
    column_spec(column=4, width="2.2cm") %>%
    column_spec(column=5, width="1.2cm")
 
```

# Risk factors for severe COVID-19 in those eligible for shielding 
\scriptsize
\setbeamertemplate{caption}{\raggedright\insertcaption\par}

```{r riskfactorsshieldedonly, echo=FALSE, warning=FALSE, message=FALSE}

library(knitr)
library(kableExtra)

options(knitr.table.format = "latex") # adds tab: prefix to labels

knitr::kable(table.shieldedonly.severecases.nocare[7:15, c(1:2, 5:6)], 
             escape=FALSE, 
             booktabs=TRUE,
			 label="coxfatal",
             row.names=TRUE,
             align=c("r", "r", "l", "l"), 
   col.names=c(clean.header(colnames(table.shieldedonly.severecases.nocare)[1:2]),
                "Rate ratio (95\\% CI)", "p-value")) %>%
    kableExtra::group_rows("School-age children in household", 2, 4, bold=FALSE) %>%
    kableExtra::group_rows("Adults in household", 5, 7, bold=FALSE) %>%
    column_spec(column=1, width="2.3cm") %>%
    column_spec(column=2, width="1.7cm") %>%
    column_spec(column=3, width="1.5cm") %>%
    column_spec(column=4, width="2.2cm") %>%
    column_spec(column=5, width="1.2cm")
 
```

# Rate ratios for severe COVID-19 associated with shielding and moderate risk condition 
```{r plotrateratio, echo=FALSE, warning=FALSE, message=FALSE, fig.width=4.25,fig.asp=0.7, fig.cap="Care home residents excluded. Line thickness is proportional to precision of estimate. Arrows indicate dates that shielding advice letters were sent."}

p.rateratio + theme(plot.title = element_blank())  + 
labs(caption = element_blank(), tag = element_blank()) +   
theme(legend.position = c(0.55, 0.85)) + theme(legend.text=element_text(size=8)) + 
theme(legend.title = element_blank())

```

# Rate ratios for severe COVID-19 associated with recent hospital exposure 
```{r plothosprateratio, echo=FALSE, warning=FALSE, message=FALSE, fig.width=4.5,fig.asp=0.65, fig.cap="Care home residents excluded"}

p.hosp.rateratio + theme(plot.title = element_blank()) + 
labs(caption = element_blank(), tag = element_blank())
 
```

# Prevalence of recent hospital exposure by risk category 

```{r plotexphosp, echo=FALSE, warning=FALSE, message=FALSE, fig.width=4.25, fig.asp=0.7, fig.cap="Prevalence in controls not resident in care homes"}
p.hosp + theme(plot.title = element_blank()) + 
labs(caption = element_blank(), tag = element_blank()) + 
theme(legend.position = c(0.4, 0.8))  

```

# Fraction of severe COVID-19 attributable to recent hospital exposure 

```{r plotfrac, echo=FALSE, warning=FALSE, message=FALSE, fig.width=4.25, fig.asp=0.7, fig.cap="Care home residents excluded"}
p.fracattr + theme(plot.title = element_blank())+ 
labs(caption = element_blank(), tag = element_blank())

```

# Conclusions (1)

* For vulnerable individuals to be shielded, the risk of hospital-acquired infection must be reduced and support must be provided for other adults in the household to co-isolate with the vulnerable individual. 

* Solid organ transplant recipients are at the highest risk; vaccination of  household contacts should be considered for this group.  

* Hospital-acquired infection has made a substantial contribution to the burden of COVID-19 in the population, accounting for more than half of severe cases in early December 2020. 

# Conclusions (2)

* Expert advisory panels and policy-makers should give as much attention to nosocomial transmission as to population-wide social distancing and new variants of concern. 

* Vaccination of health care workers is expected to help. 

* It is difficult to control nosocomial transmission in buildings not designed for preventing aerosol transmission in a pandemic.  

  - noted in a report for NHS England by the Healthcare Safety Investigation Branch dated 29 October 2020. 
  
  - Designing or building separate fever hospitals should be considered.  

* Analysis of real-world data beats theoretical modelling every time

  - possibilities for collaboration between public health agencies and researchers should be fully exploited. 


